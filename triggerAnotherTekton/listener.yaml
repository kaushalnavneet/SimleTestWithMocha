apiVersion: tekton.dev/v1alpha1
kind: TriggerTemplate
metadata:
  name: template
spec:
  params:
    - name: another-pipeline-id
      description: the pipeline Id of another tekton pipeline to trigger
    - name: manual-trigger
      description: manual trigger name of another tekton pipeline
    - name: apikey
      description: the ibmcloud api key
    - name: api
      description: the ibmcloud api endpoint
      default: "https://cloud.ibm.com"
    - name: region
      description: the ibmcloud login region
      default: "us-south"
  resourcetemplates:
  # CD context defined as a configmap because it is immutable information
    - apiVersion: v1
      kind: ConfigMap
      metadata:
        name: cd-config
      data:
        API: $(params.api)
        REGION: $(params.region)
        MYTOOLCHAIN: |
          {
            "toolchain_guid": "d7d315d7-38f2-4301-ac51-ec188e5b6475",
            "name": "do not delete for now",
            "description": "do not delete for now",
            "key": "do not delete for now_19c29990ffe42ce260f5a5cb64f54169_ibm:ys1:us-south",
            "container": {
                "guid": "19c29990ffe42ce260f5a5cb64f54169",
                "type": "resource_group_id"
            },
            "crn": "crn:v1:staging:public:toolchain:us-south:a/0ba224679d6c697f9baee5e14ade83ac:d7d315d7-38f2-4301-ac51-ec188e5b6475::",
            "created": "2018-07-11T18:42:15.611Z",
            "updated_at": "2019-04-29T15:56:58.323Z",
            "creator": "cbfe544a-5967-4255-973c-7e43b9b89b53",
            "generator": "otc_setup",
            "template": {
                "getting_started": "**Your toolchain is ready!**\n**Quick start:** Commit a change to the Git repo to trigger a new build and deployment. For step-by-step instructions, see the [tutorial](https://www.ibm.com/devops/method/tutorials/tutorial_toolchain_cfv2?task=2) for this toolchain.",
                "services_total": 3,
                "name": "Develop a Cloud Foundry app",
                "type": "template",
                "url": "https://github.com/open-toolchain/simple-toolchain-hosted",
                "source": "repo"
            },
            "tags": [],
            "lifecycle_messaging_webhook_id": "9a6044768a370062f549547b9a58a31c",
            "region_id": "ibm:ys1:us-south",
            "services": [
                {
                    "broker_id": "12345678-9123-4567-8912-345678012pipeline",
                    "service_id": "pipeline",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-28T21:51:17.198Z",
                    "parameters": {
                        "label": "TekPip4",
                        "type": "tekton",
                        "name": "TekPip4",
                        "ui_pipeline": true
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "/devops/pipelines/tekton/8af11040-4388-482a-993d-520ab10d2393",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "8af11040-4388-482a-993d-520ab10d2393",
                    "description": "Automate your builds, deployments, and more.",
                    "tags": [
                        "ibm",
                        "deliver",
                        "build",
                        "deploy",
                        "pipeline",
                        "cicd"
                    ],
                    "url": "https://otc-pipeline-broker.stage1.ng.bluemix.net/pipeline-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        }
                    }
                },
                {
                    "broker_id": "12345678-9123-4567-8912-345678012githubintegrated",
                    "service_id": "github_integrated",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T19:04:12.240Z",
                    "parameters": {
                        "extra_capabilities": [
                            {
                                "capability_id": "git.issues",
                                "display_name": "Issues",
                                "dashboard_url": "https://github.ibm.com/org-ids/otc-ui/issues",
                                "label": "otc-ui",
                                "tags": [
                                    "think",
                                    "code"
                                ],
                                "enabled": false,
                                "readme": false
                            }
                        ],
                        "label": "otc-ui",
                        "type": "link",
                        "legal": true,
                        "owner_id": "org-ids",
                        "repo_name": "otc-ui",
                        "repo_url": "https://github.ibm.com/org-ids/otc-ui.git",
                        "source_repo_url": "",
                        "private_repo": false,
                        "has_issues": false,
                        "enable_traceability": false,
                        "git_id": "integrated",
                        "api_root_url": "https://github.ibm.com/api",
                        "token_url": "https://otc-github-consolidated-broker.us-south.devops.dev.cloud.ibm.com/github/token?git_id=integrated"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "https://github.ibm.com/org-ids/otc-ui",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "d36fc491-d0e8-4abb-a78a-7dcd091a176a",
                    "description": "Internal GitHub Enterprise allowing IBM Confidential projects.",
                    "tags": [
                        "ibm",
                        "code",
                        "collaboration",
                        "scm",
                        "private",
                        "git",
                        "version-control",
                        "planning"
                    ],
                    "url": "https://otc-github-integrated-broker.stage1.ng.bluemix.net/github-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "webhook_id": "69f65da5efc114fd198f91a1a4cd2fed"
                    }
                },
                {
                    "broker_id": "12345678-9123-4567-8912-345678012githubintegrated",
                    "service_id": "github_integrated",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2020-01-20T16:14:31.042Z",
                    "parameters": {
                        "extra_capabilities": [
                            {
                                "capability_id": "git.issues",
                                "display_name": "Issues",
                                "dashboard_url": "https://github.ibm.com/xinyij/ContinuousDelivery/issues",
                                "label": "ContinuousDelivery",
                                "tags": [
                                    "think",
                                    "code"
                                ],
                                "enabled": false,
                                "readme": false
                            }
                        ],
                        "label": "ContinuousDelivery",
                        "type": "link",
                        "legal": true,
                        "owner_id": "xinyij",
                        "repo_name": "ContinuousDelivery",
                        "repo_url": "https://github.ibm.com/xinyij/ContinuousDelivery.git",
                        "source_repo_url": "",
                        "private_repo": false,
                        "has_issues": false,
                        "enable_traceability": false,
                        "git_id": "integrated",
                        "api_root_url": "https://github.ibm.com/api",
                        "token_url": "https://otc-github-consolidated-broker.us-south.devops.dev.cloud.ibm.com/github/token?git_id=integrated"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "https://github.ibm.com/xinyij/ContinuousDelivery",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "a3cf6dcd-ea44-4f4c-978e-5053ffe061eb",
                    "description": "Internal GitHub Enterprise allowing IBM Confidential projects.",
                    "tags": [
                        "ibm",
                        "code",
                        "collaboration",
                        "scm",
                        "private",
                        "git",
                        "version-control",
                        "planning"
                    ],
                    "url": "https://otc-github-integrated-broker.stage1.ng.bluemix.net/github-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "webhook_id": "e768b056ce026a680bd00842b2134c63"
                    }
                },
                {
                    "broker_id": "0a26038a-d2bf-4e77-86e0-3a564665ebc7",
                    "service_id": "bitbucketgit",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T18:58:40.902Z",
                    "parameters": {
                        "label": "simple-toolchain-20191014192900084",
                        "type": "link",
                        "git_id": "c73b8361-6db4-4c67-a215-0be508098c05",
                        "owner_id": "~SOARESSS",
                        "authorized_users": "",
                        "repo_name": "simple-toolchain-20191014192900084",
                        "repo_url": "https://bitbucket.git.dev.cloud.ibm.com/scm/~soaresss/simple-toolchain-20191014192900084.git",
                        "source_repo_url": "",
                        "private_repo": false,
                        "has_issues": true,
                        "enable_traceability": false,
                        "authorized": "c73b8361-6db4-4c67-a215-0be508098c05",
                        "api_root_url": "https://bitbucket.git.dev.cloud.ibm.com/rest/api/1.0",
                        "token_url": "https://otc-github-consolidated-broker.us-south.devops.dev.cloud.ibm.com/github/token?git_id=c73b8361-6db4-4c67-a215-0be508098c05",
                        "git_type": "BitbucketServer"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "https://bitbucket.git.dev.cloud.ibm.com/scm/~soaresss/simple-toolchain-20191014192900084.git",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "76f47fcf-d560-4b54-bc49-10b571644f4d",
                    "description": "Store and manage code on bitbucket.org.",
                    "tags": [
                        "third-party",
                        "code",
                        "collaboration",
                        "scm",
                        "git",
                        "version-control"
                    ],
                    "url": "https://otc-github-consolidated-broker.stage1.ng.bluemix.net/github-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "webhook_id": "bb014714f94d386078f7b0d42cfb10f9"
                    }
                },
                {
                    "broker_id": "12345678-9123-4567-8912-345678012saucelabs",
                    "service_id": "saucelabs",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T19:43:12.053Z",
                    "parameters": {
                        "label": "jiangxin87",
                        "toolchainId": "d7d315d7-38f2-4301-ac51-ec188e5b6475",
                        "env_id": "ibm:ys1:us-south",
                        "username": "jiangxin87",
                        "key": "48b4f6db-c930-4d97-9922-3922c06b5ffd"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "https://saucelabs.com/account",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "6f7559ae-6758-4b0f-892f-fedfab604626",
                    "description": "Automate continuous integration testing for your project.",
                    "tags": [
                        "third-party",
                        "code",
                        "manage",
                        "test",
                        "quality"
                    ],
                    "url": "https://otc-saucelabs-broker.stage1.ng.bluemix.net/saucelabs-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        }
                    }
                },
                {
                    "broker_id": "0a26038a-d2bf-4e77-86e0-3a564665ebc7",
                    "service_id": "bitbucketgit",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T18:58:34.591Z",
                    "parameters": {
                        "label": "test",
                        "type": "link",
                        "git_id": "49622854-6df2-44f1-99cf-9dc71a4b450d",
                        "owner_id": "~SIDNEY",
                        "authorized_users": "",
                        "repo_name": "test",
                        "repo_url": "https://bitbucket.git.dev.cloud.ibm.com/scm/~sidney/test.git",
                        "source_repo_url": "",
                        "private_repo": false,
                        "has_issues": true,
                        "enable_traceability": false,
                        "authorized": "49622854-6df2-44f1-99cf-9dc71a4b450d",
                        "api_root_url": "https://bitbucket.git.dev.cloud.ibm.com/rest/api/1.0",
                        "token_url": "https://otc-github-consolidated-broker.us-south.devops.dev.cloud.ibm.com/github/token?git_id=49622854-6df2-44f1-99cf-9dc71a4b450d",
                        "git_type": "BitbucketServer"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "https://bitbucket.git.dev.cloud.ibm.com/scm/~sidney/test.git",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "2b95791e-7008-441c-b2b1-2843524669b2",
                    "description": "Store and manage code on bitbucket.org.",
                    "tags": [
                        "third-party",
                        "code",
                        "collaboration",
                        "scm",
                        "git",
                        "version-control"
                    ],
                    "url": "https://otc-github-consolidated-broker.stage1.ng.bluemix.net/github-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "webhook_id": "6d18524398589e48ce13fb2d61c57f06"
                    }
                },
                {
                    "broker_id": "12345678-9123-4567-8912-345678012pipeline",
                    "service_id": "pipeline",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2020-01-24T18:40:02.789Z",
                    "parameters": {
                        "label": "ForLocalCluster_tekton",
                        "type": "tekton",
                        "name": "ForLocalCluster_tekton",
                        "ui_pipeline": true
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "/devops/pipelines/tekton/aeab6877-66c8-4459-b07b-2d2672c9733f",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "aeab6877-66c8-4459-b07b-2d2672c9733f",
                    "description": "Automate your builds, deployments, and more.",
                    "tags": [
                        "ibm",
                        "deliver",
                        "build",
                        "deploy",
                        "pipeline",
                        "cicd"
                    ],
                    "url": "https://otc-pipeline-broker.stage1.ng.bluemix.net/pipeline-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "webhook_id": "e00757408e1b34ee39bf19d8cc5d134c"
                    }
                },
                {
                    "broker_id": "0a26038a-d2bf-4e77-86e0-3a564665ebc7",
                    "service_id": "bitbucketgit",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-26T14:53:39.195Z",
                    "parameters": {
                        "label": "test",
                        "type": "link",
                        "git_id": "49622854-6df2-44f1-99cf-9dc71a4b450d",
                        "owner_id": "~SIDNEY",
                        "repo_name": "test",
                        "repo_url": "https://bitbucket.git.dev.cloud.ibm.com/scm/~sidney/test.git",
                        "source_repo_url": "",
                        "private_repo": true,
                        "has_issues": true,
                        "enable_traceability": false,
                        "authorized": "49622854-6df2-44f1-99cf-9dc71a4b450d",
                        "api_root_url": "https://bitbucket.git.dev.cloud.ibm.com/rest/api/1.0",
                        "token_url": "https://otc-github-consolidated-broker.us-south.devops.dev.cloud.ibm.com/github/token?git_id=49622854-6df2-44f1-99cf-9dc71a4b450d",
                        "git_type": "BitbucketServer"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "https://bitbucket.git.dev.cloud.ibm.com/scm/~sidney/test.git",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "2289de0d-ec2b-4ab5-8567-b77b867dde14",
                    "description": "Store and manage code on bitbucket.org.",
                    "tags": [
                        "third-party",
                        "code",
                        "collaboration",
                        "scm",
                        "git",
                        "version-control"
                    ],
                    "url": "https://otc-github-consolidated-broker.stage1.ng.bluemix.net/github-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "webhook_id": "4b8e74f63868843119efa9446c1b0700"
                    }
                },
                {
                    "broker_id": "12345678-9123-4567-8912-345678012pipeline",
                    "service_id": "pipeline",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T19:35:41.074Z",
                    "parameters": {
                        "label": "CustomBBTest",
                        "type": "classic",
                        "name": "CustomBBTest",
                        "ui_pipeline": true,
                        "api_url": "http://pipeline-service/pipeline/pipelines/8de07c4d-5395-4c86-ac1b-649f400ac24b",
                        "external_api_url": "https://pipeline-service.us-south.devops.dev.cloud.ibm.com/pipeline/pipelines/8de07c4d-5395-4c86-ac1b-649f400ac24b"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "/devops/pipelines/8de07c4d-5395-4c86-ac1b-649f400ac24b",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "8de07c4d-5395-4c86-ac1b-649f400ac24b",
                    "description": "Automate your builds, deployments, and more.",
                    "tags": [
                        "ibm",
                        "deliver",
                        "build",
                        "deploy",
                        "pipeline",
                        "cicd"
                    ],
                    "url": "https://otc-pipeline-broker.stage1.ng.bluemix.net/pipeline-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "webhook_id": "b66e74c3f4b0afa953962f6334af54c9"
                    }
                },
                {
                    "broker_id": "12345678-9123-4567-8912-345678012pipeline",
                    "service_id": "pipeline",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T19:30:34.272Z",
                    "parameters": {
                        "label": "E2E-Dev-dev",
                        "type": "classic",
                        "name": "E2E-Dev-dev",
                        "ui_pipeline": true,
                        "api_url": "http://pipeline-service/pipeline/pipelines/39e71272-b8cd-4761-9378-3faaee13c6ac",
                        "external_api_url": "https://pipeline-service.us-south.devops.dev.cloud.ibm.com/pipeline/pipelines/39e71272-b8cd-4761-9378-3faaee13c6ac"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "/devops/pipelines/39e71272-b8cd-4761-9378-3faaee13c6ac",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "39e71272-b8cd-4761-9378-3faaee13c6ac",
                    "description": "Automate your builds, deployments, and more.",
                    "tags": [
                        "ibm",
                        "deliver",
                        "build",
                        "deploy",
                        "pipeline",
                        "cicd"
                    ],
                    "url": "https://otc-pipeline-broker.stage1.ng.bluemix.net/pipeline-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "webhook_id": "574d4a5434e8d87bfd264518198f7d1a"
                    }
                },
                {
                    "broker_id": "12345678-9123-4567-8912-345678012pipeline",
                    "service_id": "pipeline",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T19:38:38.288Z",
                    "parameters": {
                        "label": "TektonPipeline",
                        "type": "tekton",
                        "name": "TektonPipeline",
                        "ui_pipeline": true
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "/devops/pipelines/tekton/c0145da1-6176-46f1-a43b-15a4ed17a8b5",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "c0145da1-6176-46f1-a43b-15a4ed17a8b5",
                    "description": "Automate your builds, deployments, and more.",
                    "tags": [
                        "ibm",
                        "deliver",
                        "build",
                        "deploy",
                        "pipeline",
                        "cicd"
                    ],
                    "url": "https://otc-pipeline-broker.stage1.ng.bluemix.net/pipeline-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        }
                    }
                },
                {
                    "broker_id": "12345678-9123-4567-8912-345678012githubintegrated",
                    "service_id": "github_integrated",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T19:03:59.277Z",
                    "parameters": {
                        "extra_capabilities": [
                            {
                                "capability_id": "git.issues",
                                "display_name": "Issues",
                                "dashboard_url": "https://github.ibm.com/ids-env/devops-dev/issues",
                                "label": "devops-dev",
                                "tags": [
                                    "think",
                                    "code"
                                ],
                                "enabled": false,
                                "readme": false
                            }
                        ],
                        "label": "devops-dev",
                        "type": "link",
                        "legal": true,
                        "owner_id": "ids-env",
                        "repo_name": "devops-dev",
                        "repo_url": "https://github.ibm.com/ids-env/devops-dev.git",
                        "source_repo_url": "",
                        "private_repo": true,
                        "has_issues": false,
                        "enable_traceability": false,
                        "git_id": "integrated",
                        "api_root_url": "https://github.ibm.com/api",
                        "token_url": "https://otc-github-consolidated-broker.us-south.devops.dev.cloud.ibm.com/github/token?git_id=integrated"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "https://github.ibm.com/ids-env/devops-dev",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "4a7a22a3-9143-44ac-b8af-2a78f52b2895",
                    "description": "Internal GitHub Enterprise allowing IBM Confidential projects.",
                    "tags": [
                        "ibm",
                        "code",
                        "collaboration",
                        "scm",
                        "private",
                        "git",
                        "version-control",
                        "planning"
                    ],
                    "url": "https://otc-github-integrated-broker.stage1.ng.bluemix.net/github-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "webhook_id": "59684e6ba0bf65cd89bc429a8660cdb1"
                    }
                },
                {
                    "broker_id": "fe8c9dae-f51c-4ff3-815f-f64c5a9b0a3e",
                    "service_id": "githubconsolidated",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T19:04:23.287Z",
                    "parameters": {
                        "extra_capabilities": [
                            {
                                "capability_id": "git.issues",
                                "display_name": "Issues",
                                "dashboard_url": "https://github.com/eclipse/orion.client/issues",
                                "label": "orion.client",
                                "tags": [
                                    "think",
                                    "code"
                                ],
                                "enabled": false,
                                "readme": false
                            }
                        ],
                        "label": "orion.client",
                        "type": "link",
                        "legal": false,
                        "git_id": "github",
                        "repo_url": "https://github.com/eclipse/orion.client.git",
                        "private_repo": false,
                        "has_issues": false,
                        "auto_init": false,
                        "enable_traceability": false,
                        "authorized": "github",
                        "owner_id": "eclipse",
                        "repo_name": "orion.client",
                        "api_root_url": "https://api.github.com",
                        "token_url": "https://otc-github-consolidated-broker.us-south.devops.dev.cloud.ibm.com/github/token?git_id=github"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "https://github.com/eclipse/orion.client",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "30cc0c1e-ae6e-485b-aa33-4e6d68cd67b9",
                    "description": "Store and manage code on GitHub.com or on your own GitHub Enterprise server.",
                    "tags": [
                        "third-party",
                        "code",
                        "collaboration",
                        "scm",
                        "git",
                        "version-control",
                        "planning"
                    ],
                    "url": "https://otc-github-consolidated-broker.stage1.ng.bluemix.net/github-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "webhook_id": "9153faa4f169e8a9211dc8fcd63d844a"
                    }
                },
                {
                    "broker_id": "12345678-9123-4567-8912-345678012pipeline",
                    "service_id": "private_worker",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2020-01-24T18:09:13.777Z",
                    "parameters": {
                        "label": "localAgentSidney",
                        "name": "localAgentSidney",
                        "workerQueueCredentials": "nCxqvW6jVFV3aC7Up-57-BDNqLwL3tCx8WzFyUwuXH_t",
                        "workerQueueIdentifier": "ServiceId-50e7d222-d607-4f3e-a3f4-18f36d89773d"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "/devops/pipelines/worker/c77a1377-c441-40a5-b0bb-c23390a380b4",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "c77a1377-c441-40a5-b0bb-c23390a380b4",
                    "description": "Run pipeline workloads on your own infrastructure.",
                    "tags": [
                        "ibm",
                        "deliver",
                        "build",
                        "deploy",
                        "pipeline",
                        "cicd"
                    ],
                    "url": "https://otc-pipeline-broker.stage1.ng.bluemix.net/pipeline-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        }
                    }
                },
                {
                    "broker_id": "fe8c9dae-f51c-4ff3-815f-f64c5a9b0a3e",
                    "service_id": "githubconsolidated",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T19:04:18.141Z",
                    "parameters": {
                        "extra_capabilities": [
                            {
                                "capability_id": "git.issues",
                                "display_name": "Issues",
                                "dashboard_url": "https://github.com/SidneyJiang/SimleTestWithMocha/issues",
                                "label": "SimleTestWithMocha",
                                "tags": [
                                    "think",
                                    "code"
                                ],
                                "enabled": false,
                                "readme": false
                            }
                        ],
                        "label": "SimleTestWithMocha",
                        "type": "link",
                        "legal": false,
                        "git_id": "github",
                        "repo_url": "https://github.com/SidneyJiang/SimleTestWithMocha.git",
                        "private_repo": true,
                        "has_issues": false,
                        "auto_init": false,
                        "enable_traceability": false,
                        "authorized": "github",
                        "owner_id": "SidneyJiang",
                        "repo_name": "SimleTestWithMocha",
                        "api_root_url": "https://api.github.com",
                        "token_url": "https://otc-github-consolidated-broker.us-south.devops.dev.cloud.ibm.com/github/token?git_id=github"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "https://github.com/SidneyJiang/SimleTestWithMocha",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "0c215516-82d8-4d86-a431-a444d2c58f9d",
                    "description": "Store and manage code on GitHub.com or on your own GitHub Enterprise server.",
                    "tags": [
                        "third-party",
                        "code",
                        "collaboration",
                        "scm",
                        "git",
                        "version-control",
                        "planning"
                    ],
                    "url": "https://otc-github-consolidated-broker.stage1.ng.bluemix.net/github-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "webhook_id": "092c91e0812227bb92f350c5d60093fd"
                    }
                },
                {
                    "broker_id": "0a26038a-d2bf-4e77-86e0-3a564665ebc7",
                    "service_id": "bitbucketgit",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-20T21:21:18.731Z",
                    "parameters": {
                        "extra_capabilities": [
                            {
                                "capability_id": "git.issues",
                                "display_name": "Issues",
                                "dashboard_url": "https://bitbucket.org/SoulBeing/englisheverydaynodeserver/issues",
                                "label": "EnglishEverydayNodeServer",
                                "tags": [
                                    "think",
                                    "code"
                                ],
                                "enabled": true,
                                "readme": false
                            }
                        ],
                        "label": "EnglishEverydayNodeServer",
                        "type": "link",
                        "git_id": "bitbucketgit",
                        "authorized_users": "",
                        "repo_url": "https://bitbucket.org/SoulBeing/englisheverydaynodeserver.git",
                        "private_repo": true,
                        "has_issues": true,
                        "enable_traceability": false,
                        "authorized": "bitbucketgit",
                        "owner_id": "SoulBeing",
                        "repo_name": "EnglishEverydayNodeServer",
                        "api_root_url": "https://api.bitbucket.org",
                        "token_url": "https://otc-github-consolidated-broker.us-south.devops.dev.cloud.ibm.com/github/token?git_id=bitbucketgit"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "https://bitbucket.org/SoulBeing/englisheverydaynodeserver",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "5f5ba344-a927-4f94-ad04-93b9cc7eadef",
                    "description": "Store and manage code on bitbucket.org.",
                    "tags": [
                        "third-party",
                        "code",
                        "collaboration",
                        "scm",
                        "git",
                        "version-control"
                    ],
                    "url": "https://otc-github-consolidated-broker.stage1.ng.bluemix.net/github-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "webhook_id": "7e265131341b4d16840c035995de79a6"
                    }
                },
                {
                    "broker_id": "91f9764f-b0f4-4306-813c-452ba120305edra",
                    "service_id": "draservicebroker",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T19:02:21.772Z",
                    "parameters": {
                        "cf_controller": "https://api.stage1.ng.bluemix.net",
                        "dra_server": "https://gateservice-dev.us-south.devopsinsights.cloud.ibm.com",
                        "dlms_server": "https://dlms-dev.us-south.devopsinsights.cloud.ibm.com",
                        "dashboard_url": "https://dev.console.test.cloud.ibm.com/devops/insights/overview?toolchainId=d7d315d7-38f2-4301-ac51-ec188e5b6475",
                        "env_id": "ibm:ys1:us-south"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "https://dev.console.test.cloud.ibm.com/devops/insights/overview?toolchainId=d7d315d7-38f2-4301-ac51-ec188e5b6475",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "aba6774d-c73b-44e9-8646-3f5aceb150f3",
                    "description": "Use analytics to determine whether to deploy.",
                    "tags": [
                        "ibm",
                        "learn",
                        "productivity",
                        "quality"
                    ],
                    "url": "https://otcbroker-dev.us-south.devopsinsights.cloud.ibm.com/draservicebroker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        }
                    }
                },
                {
                    "broker_id": "92d3a2f2-e71a-491c-9f50-a1dfc30orion",
                    "service_id": "orion",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T19:21:51.060Z",
                    "parameters": {
                        "container_url": "",
                        "toolchain_id": "d7d315d7-38f2-4301-ac51-ec188e5b6475",
                        "dashboard_url": "/devops/code/edit/edit.html#,toolchain=d7d315d7-38f2-4301-ac51-ec188e5b6475"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "/devops/code/edit/edit.html#,toolchain=d7d315d7-38f2-4301-ac51-ec188e5b6475",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "53155328-b5c5-446d-bdc4-c1d1fbc727ae",
                    "description": "A browser-based IDE for web and cloud development.",
                    "tags": [
                        "ibm",
                        "code",
                        "ide",
                        "edit"
                    ],
                    "url": "https://otc-orion-broker.stage1.ng.bluemix.net/orion-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "name": "webide"
                    }
                },
                {
                    "broker_id": "12345678-9123-4567-8912-345678012pipeline",
                    "service_id": "pipeline",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T19:41:43.547Z",
                    "parameters": {
                        "label": "goodTestForNow",
                        "services": [
                            "sample-repo"
                        ],
                        "name": "goodTestForNow",
                        "ui-pipeline": true,
                        "configuration": {
                            "content": "---\nstages:\n- name: BUILD\n  inputs:\n  - type: git\n    branch: master\n    service: ${SAMPLE_REPO}\n  triggers:\n  - type: commit\n  jobs:\n  - name: Build\n    type: builder\n- name: DEPLOY\n  inputs:\n  - type: job\n    stage: BUILD\n    job: Build\n  triggers:\n  - type: stage\n  properties:\n  - name: CF_APP_NAME\n    value: undefined\n    type: text\n  - name: APP_URL\n    value: undefined\n    type: text\n  jobs:\n  - name: Rolling Deploy\n    type: deployer\n    target:\n      region_id: ${PROD_REGION_ID}\n      organization: ${PROD_ORG_NAME}\n      space: ${PROD_SPACE_NAME}\n      application: ${CF_APP_NAME}\n      api_key: ${API_KEY}\n    script: |\n      #!/bin/bash\n      # Push app\n      if ! cf app $CF_APP; then  \n        cf push $CF_APP\n      else\n        OLD_CF_APP=${CF_APP}-OLD-$(date +\"%s\")\n        rollback() {\n          set +e  \n          if cf app $OLD_CF_APP; then\n            cf logs $CF_APP --recent\n            cf delete $CF_APP -f\n            cf rename $OLD_CF_APP $CF_APP\n          fi\n          exit 1\n        }\n        set -e\n        trap rollback ERR\n        cf rename $CF_APP $OLD_CF_APP\n        cf push $CF_APP\n        cf delete $OLD_CF_APP -f\n      fi\n      # Export app name and URL for use in later Pipeline jobs\n      export CF_APP_NAME=\"$CF_APP\"\n      export APP_URL=http://$(cf app $CF_APP_NAME | grep -e urls: -e routes: | awk '{print $2}')\n      # View logs\n      #cf logs \"${CF_APP}\" --recent\n      \n",
                            "env": {
                                "SAMPLE_REPO": "sample-repo",
                                "CF_APP_NAME": "goodTestForNow",
                                "PROD_SPACE_NAME": "dev",
                                "PROD_ORG_NAME": "Orion",
                                "PROD_REGION_ID": "ibm:ys1:us-south",
                                "API_KEY": "JCG4pt0VEV7UiOXgMvTcSfkQoBM7E4epzW2gt921jUku"
                            },
                            "execute": true
                        },
                        "ui_pipeline": true,
                        "api_url": "http://pipeline-service/pipeline/pipelines/f2b3765c-7b62-4363-9b1a-9ded488810ae",
                        "external_api_url": "https://pipeline-service.dev.us-south.devops.cloud.ibm.com/pipeline/pipelines/f2b3765c-7b62-4363-9b1a-9ded488810ae"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "/devops/pipelines/f2b3765c-7b62-4363-9b1a-9ded488810ae",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "f2b3765c-7b62-4363-9b1a-9ded488810ae",
                    "description": "Automate your builds, deployments, and more.",
                    "tags": [
                        "ibm",
                        "deliver",
                        "build",
                        "deploy",
                        "pipeline",
                        "cicd"
                    ],
                    "url": "https://otc-pipeline-broker.stage1.ng.bluemix.net/pipeline-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "name": "sample-build",
                        "webhook_id": "60aa18dcb6b1c5238558a0e19f53ce7d"
                    }
                },
                {
                    "broker_id": "12345678-9123-4567-8912-345678012githubintegrated",
                    "service_id": "github_integrated",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T19:04:04.710Z",
                    "parameters": {
                        "extra_capabilities": [
                            {
                                "capability_id": "git.issues",
                                "display_name": "Issues",
                                "dashboard_url": "https://github.ibm.com/ids-env/devops-dev/issues",
                                "label": "devops-dev",
                                "tags": [
                                    "think",
                                    "code"
                                ],
                                "enabled": false,
                                "readme": false
                            }
                        ],
                        "label": "devops-dev",
                        "type": "link",
                        "legal": true,
                        "owner_id": "ids-env",
                        "repo_name": "devops-dev",
                        "repo_url": "https://github.ibm.com/ids-env/devops-dev.git",
                        "source_repo_url": "",
                        "private_repo": true,
                        "has_issues": false,
                        "enable_traceability": false,
                        "git_id": "integrated",
                        "api_root_url": "https://github.ibm.com/api",
                        "token_url": "https://otc-github-consolidated-broker.us-south.devops.dev.cloud.ibm.com/github/token?git_id=integrated"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "https://github.ibm.com/ids-env/devops-dev",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "850d6717-eb9a-4c88-91a6-88a8cf63e70c",
                    "description": "Internal GitHub Enterprise allowing IBM Confidential projects.",
                    "tags": [
                        "ibm",
                        "code",
                        "collaboration",
                        "scm",
                        "private",
                        "git",
                        "version-control",
                        "planning"
                    ],
                    "url": "https://otc-github-integrated-broker.stage1.ng.bluemix.net/github-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "webhook_id": "7713944857f5bfb786cd644126072c47"
                    }
                },
                {
                    "broker_id": "12345678-9123-4567-8912-345678012pipeline",
                    "service_id": "private_worker",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T19:42:34.239Z",
                    "parameters": {
                        "label": "private-worker-Sid3",
                        "name": "private-worker-Sid3",
                        "workerQueueCredentials": "BvVJx0Q4iR8MJ88SoNVsxxo9Cuumk95jvo-uUrbeDLkR",
                        "workerQueueIdentifier": "ServiceId-a31a1f40-8909-45f3-aab9-b148dd18198d"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "/devops/pipelines/worker/6d1cfa97-6a73-4a72-814a-25ff170110bc",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "6d1cfa97-6a73-4a72-814a-25ff170110bc",
                    "description": "Run pipeline workloads on your own infrastructure.",
                    "tags": [
                        "ibm",
                        "deliver",
                        "build",
                        "deploy",
                        "pipeline",
                        "cicd"
                    ],
                    "url": "https://otc-pipeline-broker.stage1.ng.bluemix.net/pipeline-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        }
                    }
                },
                {
                    "broker_id": "12345678-9123-4567-8912-345678012hostedgit",
                    "service_id": "hostedgit",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T19:16:21.686Z",
                    "parameters": {
                        "extra_capabilities": [
                            {
                                "capability_id": "git.issues",
                                "display_name": "Issues",
                                "dashboard_url": "https://us-south.git.dev.cloud.ibm.com/xinyij/simple-toolchain-20190528203549900/issues",
                                "label": "simple-toolchain-20190528203549900",
                                "tags": [
                                    "think",
                                    "code"
                                ],
                                "enabled": true,
                                "readme": false
                            }
                        ],
                        "label": "simple-toolchain-20190528203549900",
                        "type": "link",
                        "git_id": "hostedgit",
                        "repo_url": "https://us-south.git.dev.cloud.ibm.com/xinyij/simple-toolchain-20190528203549900.git",
                        "private_repo": true,
                        "has_issues": true,
                        "enable_traceability": false,
                        "authorized": "hostedgit",
                        "owner_id": "xinyij",
                        "repo_name": "simple-toolchain-20190528203549900",
                        "api_root_url": "https://us-south.git.dev.cloud.ibm.com/api",
                        "token_url": "https://otc-github-consolidated-broker.us-south.devops.dev.cloud.ibm.com/github/token?git_id=hostedgit"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "https://us-south.git.dev.cloud.ibm.com/xinyij/simple-toolchain-20190528203549900",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "b3ce10a5-1e45-44b0-95da-dab52c9daf8b",
                    "description": "IBM hosted repos and issue tracking based on GitLab Community Edition.",
                    "tags": [
                        "ibm",
                        "code",
                        "collaboration",
                        "scm",
                        "git",
                        "version-control",
                        "planning"
                    ],
                    "url": "https://otc-hosted-git-broker.stage1.ng.bluemix.net/github-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "webhook_id": "07505b37c2089d78a133685c5a3e2aae"
                    }
                },
                {
                    "broker_id": "fe8c9dae-f51c-4ff3-815f-f64c5a9b0a3e",
                    "service_id": "githubconsolidated",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T19:04:23.979Z",
                    "parameters": {
                        "extra_capabilities": [
                            {
                                "capability_id": "git.issues",
                                "display_name": "Issues",
                                "dashboard_url": "https://github.com/bogg/testPRJuly/issues",
                                "label": "testPRJuly",
                                "tags": [
                                    "think",
                                    "code"
                                ],
                                "enabled": false,
                                "readme": false
                            }
                        ],
                        "label": "testPRJuly",
                        "type": "link",
                        "legal": false,
                        "git_id": "github",
                        "repo_url": "https://github.com/bogg/testPRJuly.git",
                        "private_repo": false,
                        "has_issues": false,
                        "auto_init": false,
                        "enable_traceability": false,
                        "authorized": "github",
                        "owner_id": "bogg",
                        "repo_name": "testPRJuly",
                        "api_root_url": "https://api.github.com",
                        "token_url": "https://otc-github-consolidated-broker.us-south.devops.dev.cloud.ibm.com/github/token?git_id=github"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "https://github.com/bogg/testPRJuly",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "365a598f-4d24-4ae2-af57-5bda90a0bff5",
                    "description": "Store and manage code on GitHub.com or on your own GitHub Enterprise server.",
                    "tags": [
                        "third-party",
                        "code",
                        "collaboration",
                        "scm",
                        "git",
                        "version-control",
                        "planning"
                    ],
                    "url": "https://otc-github-consolidated-broker.stage1.ng.bluemix.net/github-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "webhook_id": "dc0791ea22b5e2e34531adfcda15c4ea"
                    }
                },
                {
                    "broker_id": "0a26038a-d2bf-4e77-86e0-3a564665ebc7",
                    "service_id": "bitbucketgit",
                    "container": {
                        "guid": "19c29990ffe42ce260f5a5cb64f54169",
                        "type": "resource_group_id"
                    },
                    "updated_at": "2019-11-29T18:58:33.798Z",
                    "parameters": {
                        "label": "node-hello-world",
                        "type": "link",
                        "git_id": "c73b8361-6db4-4c67-a215-0be508098c05",
                        "owner_id": "SP",
                        "authorized_users": "",
                        "repo_name": "node-hello-world",
                        "repo_url": "https://bitbucket.git.dev.cloud.ibm.com/scm/sp/node-hello-world.git",
                        "source_repo_url": "",
                        "private_repo": false,
                        "has_issues": true,
                        "enable_traceability": false,
                        "authorized": "c73b8361-6db4-4c67-a215-0be508098c05",
                        "api_root_url": "https://bitbucket.git.dev.cloud.ibm.com/rest/api/1.0",
                        "token_url": "https://otc-github-consolidated-broker.us-south.devops.dev.cloud.ibm.com/github/token?git_id=c73b8361-6db4-4c67-a215-0be508098c05",
                        "git_type": "BitbucketServer"
                    },
                    "status": {
                        "state": "configured"
                    },
                    "dashboard_url": "https://bitbucket.git.dev.cloud.ibm.com/scm/sp/node-hello-world.git",
                    "region_id": "ibm:ys1:us-south",
                    "instance_id": "21013e6e-3504-43fc-8ddc-1772962a9b97",
                    "description": "Store and manage code on bitbucket.org.",
                    "tags": [
                        "third-party",
                        "code",
                        "collaboration",
                        "scm",
                        "git",
                        "version-control"
                    ],
                    "url": "https://otc-github-consolidated-broker.stage1.ng.bluemix.net/github-broker/api",
                    "toolchain_binding": {
                        "status": {
                            "state": "configured"
                        },
                        "webhook_id": "e44091b2be35bf94cc81a1cedcabdba6"
                    }
                }
            ]
          }
    - apiVersion: v1
      kind: Secret
      metadata:
        name: cd-secret
      type: Opaque
      stringData:
        API_KEY: $(params.apikey)
    - apiVersion: tekton.dev/v1alpha1
      kind: PipelineRun
      metadata:
        name: pipelinerun-$(uid)
      spec:
        pipelineRef:
            name: pipeline
        params:
        - name: another-pipeline-id
          value: $(params.another-pipeline-id)
        - name: manual-trigger
          value: $(params.manual-trigger)
        - name: repository
          value: $(params.repository)
---
apiVersion: tekton.dev/v1alpha1
kind: TriggerBinding
metadata:
  name: binding
spec:
  params:
    - name: another-pipeline-id
      description: the pipeline Id of another tekton pipeline to trigger
      value: $(event.another-pipeline-id)
    - name: manual-trigger
      description: manual trigger name of another tekton pipeline
      value: $(event.manual-trigger)
    - name: apikey
      description: the ibmcloud api key
      value: $(event.apikey)
    - name: repository  # repository doesn't have to be in TriggerTemplate.params, but it has to be in resourcetemplates.PipelineRun.params
      value: $(event.repository)
---
apiVersion: tekton.dev/v1alpha1
kind: EventListener
metadata:
  name: listener
spec:
  triggers:
    - binding:
        name: binding
      template:
        name: template